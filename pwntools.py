from pwn import *


# Menghubungkan ke server
r = remote('ctf99.cs.ui.ac.id', 10002)


# Mengirimkan nama
name = b"name"
r.sendline(name)


# Menerima pesan dari server
r.recvuntil(b'10000 times\n')


# Melakukan loop untuk mengirimkan 10000 input
for i in range(10000):
   # Menerima pesan berikutnya dari server
   message = r.recvline().decode('utf-8').strip()


   # Ekstrak kata yang harus dikirimkan kembali
   word = message.split('"')[1]
   print(i, word)


   # Mengirimkan kata kembali ke server
   r.sendline(word.encode('utf-8'))


# Menerima dan mencetak pesan terakhir dari server (flag)
print(r.recvline().decode('utf-8').strip())


# Menutup koneksi
r.close()
